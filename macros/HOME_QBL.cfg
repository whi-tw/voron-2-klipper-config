[gcode_macro HOME_QBL]
gcode:
    {% set hot_clean_temp = params.HOT_CLEAN_TEMP | default(0) | float %}

    SAVE_GCODE_STATE NAME=STATE_HOME_QBL

    G90
    CG28 ; G28 if XYZ not already homed

    _HOME_QBL_HOT_CLEAN HOT_CLEAN_TEMP={hot_clean_temp}

    CQGL ; QUAD_GANTRY_LEVEL if not already applied


    STATUS_HOMING
    G28 Z

    RESTORE_GCODE_STATE NAME=STATE_HOME_QBL

    STATUS_READY

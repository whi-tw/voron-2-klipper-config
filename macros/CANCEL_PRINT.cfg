[gcode_macro CANCEL_PRINT]
description: Cancel the actual running print
rename_existing: CANCEL_PRINT_BASE
gcode:
    M117 CANCEL
    SAVE_GCODE_STATE NAME=STATE_CANCEL_PRINT
    SET_FILAMENT_SENSOR SENSOR=encoder_sensor ENABLE=0
    CANCEL_PRINT_BASE
    RESTORE_GCODE_STATE NAME=STATE_CANCEL_PRINT

    POST_PRINT

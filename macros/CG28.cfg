[gcode_macro CG28]
description: Conditional full home (ie. home if not already homed). Includes backoff to do better X Y homing.
gcode:
    {% set travel_speed = 300 %}
    {% if "xyz" not in printer.toolhead.homed_axes %}
        _RESPOND P="CG28" M="Homing X and Y"
        STATUS_HOMING
        G28 X0 Y0
        M400
        _RESPOND P="CG28" M="Backing off to 200,200"
        G0 X200 Y200 F{travel_speed * 60}
        M400
        _RESPOND P="CG28" M="Full Home"
        G28

        STATUS_READY
    {% endif %}
